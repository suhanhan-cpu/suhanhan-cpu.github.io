<!DOCTYPE html>
<html lang="zh-CN">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#<%- theme.info.theme_version %>'>
  <%- meta_generator() %>
  <meta name="Volantis" content="<%- theme.info.theme_version %>">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  <%- generate_seo(theme, page) %>
  <%- autoCanonical(config, page) %>
  <!-- 渲染优化 -->
  <%_ if (theme.dns_prefetch && theme.dns_prefetch.length){ _%>
    <meta http-equiv='x-dns-prefetch-control' content='on' />
    <%_ getList(theme.dns_prefetch).forEach(function(item){ _%>
      <link rel='dns-prefetch' href='<%- item %>'>
      <link rel="preconnect" href="<%- item %>" crossorigin>
    <%_ }) _%>
  <%_ } _%>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <%_ if (theme.csp.enable) { _%>
    <meta http-equiv="Content-Security-Policy" content="<%- theme.csp.content %>">
  <%_ } _%>
  <meta name="HandheldFriendly" content="True" >
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <%_ if (config.import && config.import.head_begin){ _%>
    <%_ getList(config.import.head_begin).forEach(function(item){ _%>
      <%- item %>
    <%_ }) _%>
  <%_ } _%>
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  <%- volantis_inject('headBegin') %>
  <!-- Custom Files headBegin end-->
  <%_ if (config.favicon) { _%>
    <link rel="shortcut icon" type='image/x-icon' href="<%- url_for(config.favicon) %>">
  <%_ } _%>
  <link rel="preload" href="<%- theme.cdn.volantis_style %>" as="style">
  <%- generate_preload_fontfamily(theme) %>
  <!-- feed -->
  <%_ if (config.feed && config.feed.path){ _%>
    <%_ getList(config.feed.path).forEach(function(item){ _%>
      <%- feed_tag(item, {title: config.title}) %>
    <%_ }) _%>
  <%_ } _%>
  <!-- 页面元数据 -->
  <%- generate_title(config, theme, page) %>
  <%- generate_keywords(config, theme, page) %>
  <%- generate_description(config, theme, page) %>
  <%- open_graph(theme.open_graph) %>
  <style>
    /* 首屏样式 */
    <%- FirstCSS() %>
  </style>
  <link rel="stylesheet" href="<%- theme.cdn.volantis_style %>" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="<%- theme.cdn.volantis_style %>"></noscript>
  <%_ if (theme.plugins.darkmode.enable) { _%>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  <%_ } _%>
  <%- partial('../_plugins/end-of-support/script') %>
  <%- partial('scripts/global') %>
  <!-- import head_end begin -->
  <%_ if (config.import && config.import.head_end){ _%>
    <%_ getList(config.import.head_end).forEach(function(item){ _%>
      <%- item %>
    <%_ }) _%>
  <%_ } _%>
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  <%- volantis_inject('headEnd') %>
  <!-- Custom Files headEnd end-->
</head>
  <body itemscope itemtype="https://schema.org.cn/WebPage">
    <!-- import body_begin begin-->
    <!-- import body_begin end-->
    <!-- Custom Files bodyBegin begin-->
    
    <!-- Custom Files bodyBegin end-->
    <header itemscope itemtype="https://schema.org.cn/WPHeader" id="l_header" class="l_header auto shadow floatable blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone'>
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412081653717.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博客"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博客"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="https://schema.org.cn/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/22/勒让德和雅可比/">
  <span hidden itemprop="publisher" itemscope itemtype="https://schema.org.cn/Organization">
    <meta itemprop="name" content="suhanhan的博客">
  </span>
  <span hidden itemprop="post" itemscope itemtype="https://schema.org.cn/Post">
    <meta itemprop="name" content="suhanhan的博客">
    <meta itemprop="description" content="目前主要还是记录一些关于CTF密码学的学习历程">
  </span>
  


  
    <span hidden>
      <meta itemprop="image" content="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png">
    </span>
  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title" itemprop="name headline">
        勒让德和雅可比
      </h1>
      <div class='new-meta-box'>
        
          
            
<div class='new-meta-item author' itemprop="author" itemscope itemtype="https://schema.org.cn/Person">
  <a itemprop="url" class='author' href="/" rel="nofollow">
    <img itemprop="image" src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/apple-touch-icon.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/apple-touch-icon.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
    <p itemprop="name">suhanhan</p>
  </a>
</div>

          
        
          
            
  
  
  
  <div class='new-meta-item category'>
    <i class="fa-solid fa-folder-open fa-fw" aria-hidden="true"></i>
    <a class="category-link" href="/categories/crypto/">crypto</a><span class="sep"></span><a class="category-link" href="/categories/crypto/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/">日常学习</a>
    
      <span hidden itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
        <a href="/categories/crypto/" itemprop="url"><span itemprop="name">crypto</span></a>
      </span>
    
      <span hidden itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
        <a href="/categories/crypto/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/" itemprop="url"><span itemprop="name">日常学习</span></a>
      </span>
    
  </div>
  



          
        
          
            <div class="new-meta-item date" itemprop="dateCreated datePublished" datetime="2024-12-22T00:35:00+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2024年12月22日</p>
  </a>
</div>

          
        
          
            


<div class="new-meta-item browse">
  <a class='notlink'>
    <p>
      <i class="fa-solid fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="busuanzi_page_pv">
        <i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i>
      </span>
        
      <span>次浏览</span>
    </p>
  </a>
</div>


          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <p>分享两题关于勒让德和雅可比的题目，以前都是拿到直接配合Tonelli_Shanks求二次剩余的，确实没太注意这个函数本身的作用</p>
<h3 id="题1"><a class="markdownIt-Anchor" href="#题1"></a> <strong>题1：</strong></h3>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a = <span class="number">288260533169915</span></span><br><span class="line">p = <span class="number">1007621497415251</span></span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;moectf&#123;xxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">flag</span>):</span><br><span class="line">    ciphertext = []</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> plaintext:</span><br><span class="line">        e = randprime(<span class="number">2</span>, p)</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            n = <span class="built_in">pow</span>(a, -e, p)</span><br><span class="line">            ciphertext.append(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n = <span class="built_in">pow</span>(-a, e ,p)</span><br><span class="line">            ciphertext.append(n)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt_flag(FLAG))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[869209361008868, 469987155014055, 477607245771711, 956121763882082, 460028889963055, 533967339350806, 476643304115038, 398098864395899, 708866397520182, 894852371427053, 830040978017214, 982890039414452, 407281601145406, 984373673613758, 331248820899125, 413731871413066, 112233590512619, 844508013531773, 660541015358267, 203847276465014, 196764266760616, 724197319842530, 812956074918088, 543222621016303, 696010102017333, 981894930207802, 267226118917619, 790129874087132, 347190586174502, 558560481026105, 950966879997572, 194292449369649, 939650649212499, 849325569453260, 954903252340838, 666432519482028, 633589915590432, 674835636376805, 411981317282694, 255883519424948, 20332021415046, 41211809179475, 615228291023827, 3174369207878, 692370202966600, 171277599642048, 550867407707890, 928211081192953, 619531888759759, 941561507423215, 227188515309784, 44358479590760, 191301655212015, 872434831540071, 139926467694171, 257184569797282, 424025125913335, 604314815606040, 688629170195562, 934061980780966, 117123867152708, 118775453146424, 650238997700650, 464296860203680, 846900558108148, 136810490139411, 734401553273199, 1003815301659353, 177890098513981, 989132152091058, 925193504078956, 16120118469157, 417698353358040, 321572997822303, 490470448511519, 143301632751724, 201665758214964, 55674980300458, 672801140720347, 538389842964759, 688041819793393, 205641306968894, 85514071959036, 765861630472651, 1002881651048918, 468366360167056, 617444592689374, 489960009824958, 277775292746563, 839649570289759, 44545172581275, 688402966446644, 63769456068611, 213999882436593, 216065701874753, 550918086303447, 537406584676363, 360111428305020, 49045746183886, 406387916012829, 616035592607376, 910420067160309, 793994862952614, 559040919034722, 563431245991661, 540696592133, 692916878493026, 196862724250440, 915740996075121, 93262251719033, 138249806426133, 804205456884944, 980827994771964, 610265656156428, 675182808097113, 871977346966751, 432436067933537, 442408025475728, 68859983520112, 981142230621570, 44959838765869, 718285129646124, 479524397547695, 589544640946059, 723473211888089, 45649254718349, 809760578240640, 924079152216550, 819111458104359, 635798987884173, 493145154891103, 930007668559676, 951257062978841, 271213718852471, 322982213108644, 399650597731932, 599981686178645, 679031137073299, 871271038222937, 181211009276874, 492456903306033, 565461124642037, 368127868271848, 818142124952965, 531075679825305, 470971994131221, 266554775796898, 667178714173757, 601760855209461, 973801647168834, 932955611573179, 560279111769633, 517548136647154, 549911181170332, 60313689384526, 949491482563099, 452808097613187, 526891136085621, 274705731912851, 434344133676355, 115452488467955, 777777483737098, 814398658724455, 910884139326892, 721153094839833, 123149817617701, 733044865256370, 453868668750506, 66612079427577, 764872507837542, 782137313744881, 24535133913719, 360725525868320, 843972203447559, 891517126809644, 360885232459056, 368491982324658, 283707800915486, 326364439338006, 577378371719791, 722856146079435, 103533837658784, 254688935670505, 377583660405763, 437013223157800, 104708446011619, 988031331348961, 6886781492092, 31048660015037, 202508578415311, 819068100189702, 945419575503259, 73138283255017, 139586913643073, 579156429956448, 1003950470653630, 43710932909704, 922978652768702, 2942054726977, 343866518172971, 681650663259700, 614368933971283, 778713632307973, 398606253834970, 652338331771108, 641949670227333, 252161824790388, 598999939736302, 316749687994360, 952960614096341, 396671237810412, 805539289473096, 358920713125289, 935634624997029, 663385581032613, 35662861967181, 651607545611746, 758681810095871, 611397958560345, 196198933017746, 886932929348591, 660636395367246, 468455431788915, 924092573734008, 950690129324433, 999587127966195, 888011838963394, 602531651309337, 872691790865711, 968486908482852, 453553188990935, 695483211524155, 202869346556262, 970853032785416, 464221034091328, 500444626777630, 938300733064411, 739460171542679, 106243138680201, 220381406498074, 736061259497615, 287985336691769, 828566732433388, 25653881073282, 621320181554384, 978367718394475, 699801594755984, 69045944311920, 918153290921350, 742496154847514, 363237956586620, 855864928899402, 800408376661392, 591608071268736, 644600617307002, 400767167982482, 909728690834744, 619305066037810, 403154906624258, 61283916530956, 841154857119583, 271928739448620, 943602826453375, 181046110086998, 505489926854412, 265242434598252, 397601251563453, 582010431811786, 867744877195598, 157197910775288, 966686261925769, 18876998620377, 389690805402299, 537227398431908, 347700971404069, 441035382034345, 130724065565645, 436020443846434, 995901787186173, 218421083750934, 171270989504749, 837304614857272, 95058522671678, 684115651758448, 759170700243634, 963623830143399, 134020269447492, 810880730174490, 197514429664776, 933293941632760, 298355176150228, 291165975126682, 652837005225218, 594968433103211, 717988266663274, 681283193706870, 94720698554954, 534912230024800, 57002875791544, 466283757471303, 98170275960806, 39674133238710, 328905545254275, 600446924183400, 170250560797853, 96447538360913, 402756881318255, 653833791145054, 624186905259950, 381562263941849, 65202471674875, 813603811804515, 82412251682881, 430813934901833, 630104191517524, 564446338863457, 521850616317191, 301536973562373, 530267275218593, 998500657074054, 7212267782858, 259640351421902, 387324702112626, 888396292341115, 749024753723971, 85418162375112, 883404575520240, 728635284501806, 407998283472092, 917783827814342, 843382891125076, 933249524460091, 237368870850561, 461947500031560, 606265478139720, 762497205024250, 196108161980785, 464712920731734, 802735147473729, 663472255956649, 80955982171827, 891052715882349, 129688607671519, 903004933201140, 813929727900992, 100503758506631, 602082014286842, 437397404488802, 47519859806478, 395180151536529, 546373743492093, 647339114173723, 411317111927540, 101696276166348, 678151959559988, 51668751683754, 265849155643268, 868421028571661, 787999759724884, 95267994279095, 689256950522950, 550554665183774, 426522315621696, 139457110594782, 807574535966969, 181385017851905, 221826095950324, 222071619532288, 419028990094469, 976525300090124, 328201093236083, 286722736191619, 492796951075221, 651514298199139, 571796506342022, 206711677756906, 47331710606546, 702594972120132, 392046509167760, 478407918714814, 592730815648701, 138641638103370, 174303830676571, 529279947866956, 137415107280702, 216392715868670, 86947465794518, 818726716800394, 340254397869880, 371508780067424, 325307981047717, 567687140806415, 822565446854328, 660813456229288, 19186753583566, 644846006777331, 141327393629965, 235920480869413, 838745724950584, 276825516838237, 662761874040532, 418355702214096, 313711926685110, 88437689500328, 460176433574732, 2450228266396, 882266239157054, 673897905650082, 206208153755434, 548920099001980, 153266184111387, 13255788142270, 922484903048545, 440748803998307, 916906240947778, 400842493149205, 220485381482889, 487235065872011, 956191700672996, 995028709816052, 494918773812268, 786696522967722, 535635917789998, 659174735355314, 463254511578315, 933226451519003, 145072370503877, 625388715158253, 426295995778131, 115935587473835, 600764310873265, 1001986508035110, 209492238677627, 654076248845276, 255757144067046, 688372647240070, 337337203838464, 515859807535188, 875162734787756, 794777961098119, 609676420444937, 212529507506835, 795546633511290, 241207048060749, 776801875116315, 481556344267066, 816808129431759, 493895095538575, 51663065130083, 872561553334056, 142484860361584, 366178848478200, 582100262745320, 442278448664580, 658722265331043, 838584617412841, 618888833439999, 841459921663339, 442091548782434, 871146541604948, 361232391335863, 267110542973009, 98775266993905, 726739643823148, 208174460713647, 436363607002850, 109080678453891, 324963987304404, 747129957189381, 629090382627354, 326901225863526, 501411395019558, 605957277216355, 924462072245263, 681742264224629, 411620165150528, 978576627121525, 942031139574369, 93231172524187, 25708686373165, 706440278468996, 89296822699255, 609549323696105, 348801631103012, 301019857245003, 568429888021619, 696641838804966, 449524020606334, 717635512592258, 621428075417344, 165738165511311, 158410762741058, 161602488447872, 382183389407570, 328907274595208, 766746904253365, 107746916578801, 659628742394117, 39850489385122, 666051397127749, 474312422270748, 261139991035351, 482902564645709, 676254393545935, 110235980231748, 299458232064890, 656749827505033, 963908115927553, 722720798875107, 905063483734809, 990795739600264, 945238054995697, 176905467315680, 259111931319224, 422601938259904, 117159396440728, 409211931685475, 396232968955842, 114107681334804, 654283725172919, 351622702709255, 679987416555993, 641640026840576, 609806003053710, 482822259657548, 356518658585635, 61811805139089, 69776954369190, 207172995482414, 423131926063329, 943649643602454, 293676703457600, 563080562597489, 908147079943053, 310010658630352, 911778151386170, 817768239483378, 693612854841870, 214788531589375, 582512152031643, 757729953753937, 856571657360108, 680607952419663, 916077663157203, 731305462677020, 66803615445082, 419287139690140, 861593185826982, 616548630486552, 565256279891822, 282588409958136, 520541630210605, 767345971760815, 656739637241909, 379580509057753, 932925281918941, 251029261628871, 725236776074076, 670964848242950, 999244627445965, 916872955089430, 213213460785344, 211432261756385, 31972183664064, 951358022841870, 284145155237805, 785243558960859, 106902570235769, 766091290254305, 795338261445944, 309041437408721, 676408097676556, 502688492691042, 305931665252032, 139617780975991, 783387572420705, 318509103806236, 279274843786582, 960812728784, 765420810885287, 675301912122800, 220900827019425, 68258429521733, 500343726947640]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这边每次的e都是素数，然后a本身就是p的二次剩余，所以一直是有</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mi>a</mi><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^2=a\ (mod\ p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p>如果两边同时e次方，仍然是有等式成立，可以判断，但是换成-a就不行了，根据这个依据来判断就行了</p>
<p>exp：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">a = <span class="number">288260533169915</span></span><br><span class="line">p = <span class="number">1007621497415251</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Legendre</span>(<span class="params">n, p</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">cip = [<span class="number">869209361008868</span>, <span class="number">469987155014055</span>, <span class="number">477607245771711</span>, <span class="number">956121763882082</span>, <span class="number">460028889963055</span>, <span class="number">533967339350806</span>, <span class="number">476643304115038</span>, <span class="number">398098864395899</span>, <span class="number">708866397520182</span>, <span class="number">894852371427053</span>, <span class="number">830040978017214</span>, <span class="number">982890039414452</span>, <span class="number">407281601145406</span>, <span class="number">984373673613758</span>, <span class="number">331248820899125</span>, <span class="number">413731871413066</span>, <span class="number">112233590512619</span>, <span class="number">844508013531773</span>, <span class="number">660541015358267</span>, <span class="number">203847276465014</span>, <span class="number">196764266760616</span>, <span class="number">724197319842530</span>, <span class="number">812956074918088</span>, <span class="number">543222621016303</span>, <span class="number">696010102017333</span>, <span class="number">981894930207802</span>, <span class="number">267226118917619</span>, <span class="number">790129874087132</span>, <span class="number">347190586174502</span>, <span class="number">558560481026105</span>, <span class="number">950966879997572</span>, <span class="number">194292449369649</span>, <span class="number">939650649212499</span>, <span class="number">849325569453260</span>, <span class="number">954903252340838</span>, <span class="number">666432519482028</span>, <span class="number">633589915590432</span>, <span class="number">674835636376805</span>, <span class="number">411981317282694</span>, <span class="number">255883519424948</span>, <span class="number">20332021415046</span>, <span class="number">41211809179475</span>, <span class="number">615228291023827</span>, <span class="number">3174369207878</span>, <span class="number">692370202966600</span>, <span class="number">171277599642048</span>, <span class="number">550867407707890</span>, <span class="number">928211081192953</span>, <span class="number">619531888759759</span>, <span class="number">941561507423215</span>, <span class="number">227188515309784</span>, <span class="number">44358479590760</span>, <span class="number">191301655212015</span>, <span class="number">872434831540071</span>, <span class="number">139926467694171</span>, <span class="number">257184569797282</span>, <span class="number">424025125913335</span>, <span class="number">604314815606040</span>, <span class="number">688629170195562</span>, <span class="number">934061980780966</span>, <span class="number">117123867152708</span>, <span class="number">118775453146424</span>, <span class="number">650238997700650</span>, <span class="number">464296860203680</span>, <span class="number">846900558108148</span>, <span class="number">136810490139411</span>, <span class="number">734401553273199</span>, <span class="number">1003815301659353</span>, <span class="number">177890098513981</span>, <span class="number">989132152091058</span>, <span class="number">925193504078956</span>, <span class="number">16120118469157</span>, <span class="number">417698353358040</span>, <span class="number">321572997822303</span>, <span class="number">490470448511519</span>, <span class="number">143301632751724</span>, <span class="number">201665758214964</span>, <span class="number">55674980300458</span>, <span class="number">672801140720347</span>, <span class="number">538389842964759</span>, <span class="number">688041819793393</span>, <span class="number">205641306968894</span>, <span class="number">85514071959036</span>, <span class="number">765861630472651</span>, <span class="number">1002881651048918</span>, <span class="number">468366360167056</span>, <span class="number">617444592689374</span>, <span class="number">489960009824958</span>, <span class="number">277775292746563</span>, <span class="number">839649570289759</span>, <span class="number">44545172581275</span>, <span class="number">688402966446644</span>, <span class="number">63769456068611</span>, <span class="number">213999882436593</span>, <span class="number">216065701874753</span>, <span class="number">550918086303447</span>, <span class="number">537406584676363</span>, <span class="number">360111428305020</span>, <span class="number">49045746183886</span>, <span class="number">406387916012829</span>, <span class="number">616035592607376</span>, <span class="number">910420067160309</span>, <span class="number">793994862952614</span>, <span class="number">559040919034722</span>, <span class="number">563431245991661</span>, <span class="number">540696592133</span>, <span class="number">692916878493026</span>, <span class="number">196862724250440</span>, <span class="number">915740996075121</span>, <span class="number">93262251719033</span>, <span class="number">138249806426133</span>, <span class="number">804205456884944</span>, <span class="number">980827994771964</span>, <span class="number">610265656156428</span>, <span class="number">675182808097113</span>, <span class="number">871977346966751</span>, <span class="number">432436067933537</span>, <span class="number">442408025475728</span>, <span class="number">68859983520112</span>, <span class="number">981142230621570</span>, <span class="number">44959838765869</span>, <span class="number">718285129646124</span>, <span class="number">479524397547695</span>, <span class="number">589544640946059</span>, <span class="number">723473211888089</span>, <span class="number">45649254718349</span>, <span class="number">809760578240640</span>, <span class="number">924079152216550</span>, <span class="number">819111458104359</span>, <span class="number">635798987884173</span>, <span class="number">493145154891103</span>, <span class="number">930007668559676</span>, <span class="number">951257062978841</span>, <span class="number">271213718852471</span>, <span class="number">322982213108644</span>, <span class="number">399650597731932</span>, <span class="number">599981686178645</span>, <span class="number">679031137073299</span>, <span class="number">871271038222937</span>, <span class="number">181211009276874</span>, <span class="number">492456903306033</span>, <span class="number">565461124642037</span>, <span class="number">368127868271848</span>, <span class="number">818142124952965</span>, <span class="number">531075679825305</span>, <span class="number">470971994131221</span>, <span class="number">266554775796898</span>, <span class="number">667178714173757</span>, <span class="number">601760855209461</span>, <span class="number">973801647168834</span>, <span class="number">932955611573179</span>, <span class="number">560279111769633</span>, <span class="number">517548136647154</span>, <span class="number">549911181170332</span>, <span class="number">60313689384526</span>, <span class="number">949491482563099</span>, <span class="number">452808097613187</span>, <span class="number">526891136085621</span>, <span class="number">274705731912851</span>, <span class="number">434344133676355</span>, <span class="number">115452488467955</span>, <span class="number">777777483737098</span>, <span class="number">814398658724455</span>, <span class="number">910884139326892</span>, <span class="number">721153094839833</span>, <span class="number">123149817617701</span>, <span class="number">733044865256370</span>, <span class="number">453868668750506</span>, <span class="number">66612079427577</span>, <span class="number">764872507837542</span>, <span class="number">782137313744881</span>, <span class="number">24535133913719</span>, <span class="number">360725525868320</span>, <span class="number">843972203447559</span>, <span class="number">891517126809644</span>, <span class="number">360885232459056</span>, <span class="number">368491982324658</span>, <span class="number">283707800915486</span>, <span class="number">326364439338006</span>, <span class="number">577378371719791</span>, <span class="number">722856146079435</span>, <span class="number">103533837658784</span>, <span class="number">254688935670505</span>, <span class="number">377583660405763</span>, <span class="number">437013223157800</span>, <span class="number">104708446011619</span>, <span class="number">988031331348961</span>, <span class="number">6886781492092</span>, <span class="number">31048660015037</span>, <span class="number">202508578415311</span>, <span class="number">819068100189702</span>, <span class="number">945419575503259</span>, <span class="number">73138283255017</span>, <span class="number">139586913643073</span>, <span class="number">579156429956448</span>, <span class="number">1003950470653630</span>, <span class="number">43710932909704</span>, <span class="number">922978652768702</span>, <span class="number">2942054726977</span>, <span class="number">343866518172971</span>, <span class="number">681650663259700</span>, <span class="number">614368933971283</span>, <span class="number">778713632307973</span>, <span class="number">398606253834970</span>, <span class="number">652338331771108</span>, <span class="number">641949670227333</span>, <span class="number">252161824790388</span>, <span class="number">598999939736302</span>, <span class="number">316749687994360</span>, <span class="number">952960614096341</span>, <span class="number">396671237810412</span>, <span class="number">805539289473096</span>, <span class="number">358920713125289</span>, <span class="number">935634624997029</span>, <span class="number">663385581032613</span>, <span class="number">35662861967181</span>, <span class="number">651607545611746</span>, <span class="number">758681810095871</span>, <span class="number">611397958560345</span>, <span class="number">196198933017746</span>, <span class="number">886932929348591</span>, <span class="number">660636395367246</span>, <span class="number">468455431788915</span>, <span class="number">924092573734008</span>, <span class="number">950690129324433</span>, <span class="number">999587127966195</span>, <span class="number">888011838963394</span>, <span class="number">602531651309337</span>, <span class="number">872691790865711</span>, <span class="number">968486908482852</span>, <span class="number">453553188990935</span>, <span class="number">695483211524155</span>, <span class="number">202869346556262</span>, <span class="number">970853032785416</span>, <span class="number">464221034091328</span>, <span class="number">500444626777630</span>, <span class="number">938300733064411</span>, <span class="number">739460171542679</span>, <span class="number">106243138680201</span>, <span class="number">220381406498074</span>, <span class="number">736061259497615</span>, <span class="number">287985336691769</span>, <span class="number">828566732433388</span>, <span class="number">25653881073282</span>, <span class="number">621320181554384</span>, <span class="number">978367718394475</span>, <span class="number">699801594755984</span>, <span class="number">69045944311920</span>, <span class="number">918153290921350</span>, <span class="number">742496154847514</span>, <span class="number">363237956586620</span>, <span class="number">855864928899402</span>, <span class="number">800408376661392</span>, <span class="number">591608071268736</span>, <span class="number">644600617307002</span>, <span class="number">400767167982482</span>, <span class="number">909728690834744</span>, <span class="number">619305066037810</span>, <span class="number">403154906624258</span>, <span class="number">61283916530956</span>, <span class="number">841154857119583</span>, <span class="number">271928739448620</span>, <span class="number">943602826453375</span>, <span class="number">181046110086998</span>, <span class="number">505489926854412</span>, <span class="number">265242434598252</span>, <span class="number">397601251563453</span>, <span class="number">582010431811786</span>, <span class="number">867744877195598</span>, <span class="number">157197910775288</span>, <span class="number">966686261925769</span>, <span class="number">18876998620377</span>, <span class="number">389690805402299</span>, <span class="number">537227398431908</span>, <span class="number">347700971404069</span>, <span class="number">441035382034345</span>, <span class="number">130724065565645</span>, <span class="number">436020443846434</span>, <span class="number">995901787186173</span>, <span class="number">218421083750934</span>, <span class="number">171270989504749</span>, <span class="number">837304614857272</span>, <span class="number">95058522671678</span>, <span class="number">684115651758448</span>, <span class="number">759170700243634</span>, <span class="number">963623830143399</span>, <span class="number">134020269447492</span>, <span class="number">810880730174490</span>, <span class="number">197514429664776</span>, <span class="number">933293941632760</span>, <span class="number">298355176150228</span>, <span class="number">291165975126682</span>, <span class="number">652837005225218</span>, <span class="number">594968433103211</span>, <span class="number">717988266663274</span>, <span class="number">681283193706870</span>, <span class="number">94720698554954</span>, <span class="number">534912230024800</span>, <span class="number">57002875791544</span>, <span class="number">466283757471303</span>, <span class="number">98170275960806</span>, <span class="number">39674133238710</span>, <span class="number">328905545254275</span>, <span class="number">600446924183400</span>, <span class="number">170250560797853</span>, <span class="number">96447538360913</span>, <span class="number">402756881318255</span>, <span class="number">653833791145054</span>, <span class="number">624186905259950</span>, <span class="number">381562263941849</span>, <span class="number">65202471674875</span>, <span class="number">813603811804515</span>, <span class="number">82412251682881</span>, <span class="number">430813934901833</span>, <span class="number">630104191517524</span>, <span class="number">564446338863457</span>, <span class="number">521850616317191</span>, <span class="number">301536973562373</span>, <span class="number">530267275218593</span>, <span class="number">998500657074054</span>, <span class="number">7212267782858</span>, <span class="number">259640351421902</span>, <span class="number">387324702112626</span>, <span class="number">888396292341115</span>, <span class="number">749024753723971</span>, <span class="number">85418162375112</span>, <span class="number">883404575520240</span>, <span class="number">728635284501806</span>, <span class="number">407998283472092</span>, <span class="number">917783827814342</span>, <span class="number">843382891125076</span>, <span class="number">933249524460091</span>, <span class="number">237368870850561</span>, <span class="number">461947500031560</span>, <span class="number">606265478139720</span>, <span class="number">762497205024250</span>, <span class="number">196108161980785</span>, <span class="number">464712920731734</span>, <span class="number">802735147473729</span>, <span class="number">663472255956649</span>, <span class="number">80955982171827</span>, <span class="number">891052715882349</span>, <span class="number">129688607671519</span>, <span class="number">903004933201140</span>, <span class="number">813929727900992</span>, <span class="number">100503758506631</span>, <span class="number">602082014286842</span>, <span class="number">437397404488802</span>, <span class="number">47519859806478</span>, <span class="number">395180151536529</span>, <span class="number">546373743492093</span>, <span class="number">647339114173723</span>, <span class="number">411317111927540</span>, <span class="number">101696276166348</span>, <span class="number">678151959559988</span>, <span class="number">51668751683754</span>, <span class="number">265849155643268</span>, <span class="number">868421028571661</span>, <span class="number">787999759724884</span>, <span class="number">95267994279095</span>, <span class="number">689256950522950</span>, <span class="number">550554665183774</span>, <span class="number">426522315621696</span>, <span class="number">139457110594782</span>, <span class="number">807574535966969</span>, <span class="number">181385017851905</span>, <span class="number">221826095950324</span>, <span class="number">222071619532288</span>, <span class="number">419028990094469</span>, <span class="number">976525300090124</span>, <span class="number">328201093236083</span>, <span class="number">286722736191619</span>, <span class="number">492796951075221</span>, <span class="number">651514298199139</span>, <span class="number">571796506342022</span>, <span class="number">206711677756906</span>, <span class="number">47331710606546</span>, <span class="number">702594972120132</span>, <span class="number">392046509167760</span>, <span class="number">478407918714814</span>, <span class="number">592730815648701</span>, <span class="number">138641638103370</span>, <span class="number">174303830676571</span>, <span class="number">529279947866956</span>, <span class="number">137415107280702</span>, <span class="number">216392715868670</span>, <span class="number">86947465794518</span>, <span class="number">818726716800394</span>, <span class="number">340254397869880</span>, <span class="number">371508780067424</span>, <span class="number">325307981047717</span>, <span class="number">567687140806415</span>, <span class="number">822565446854328</span>, <span class="number">660813456229288</span>, <span class="number">19186753583566</span>, <span class="number">644846006777331</span>, <span class="number">141327393629965</span>, <span class="number">235920480869413</span>, <span class="number">838745724950584</span>, <span class="number">276825516838237</span>, <span class="number">662761874040532</span>, <span class="number">418355702214096</span>, <span class="number">313711926685110</span>, <span class="number">88437689500328</span>, <span class="number">460176433574732</span>, <span class="number">2450228266396</span>, <span class="number">882266239157054</span>, <span class="number">673897905650082</span>, <span class="number">206208153755434</span>, <span class="number">548920099001980</span>, <span class="number">153266184111387</span>, <span class="number">13255788142270</span>, <span class="number">922484903048545</span>, <span class="number">440748803998307</span>, <span class="number">916906240947778</span>, <span class="number">400842493149205</span>, <span class="number">220485381482889</span>, <span class="number">487235065872011</span>, <span class="number">956191700672996</span>, <span class="number">995028709816052</span>, <span class="number">494918773812268</span>, <span class="number">786696522967722</span>, <span class="number">535635917789998</span>, <span class="number">659174735355314</span>, <span class="number">463254511578315</span>, <span class="number">933226451519003</span>, <span class="number">145072370503877</span>, <span class="number">625388715158253</span>, <span class="number">426295995778131</span>, <span class="number">115935587473835</span>, <span class="number">600764310873265</span>, <span class="number">1001986508035110</span>, <span class="number">209492238677627</span>, <span class="number">654076248845276</span>, <span class="number">255757144067046</span>, <span class="number">688372647240070</span>, <span class="number">337337203838464</span>, <span class="number">515859807535188</span>, <span class="number">875162734787756</span>, <span class="number">794777961098119</span>, <span class="number">609676420444937</span>, <span class="number">212529507506835</span>, <span class="number">795546633511290</span>, <span class="number">241207048060749</span>, <span class="number">776801875116315</span>, <span class="number">481556344267066</span>, <span class="number">816808129431759</span>, <span class="number">493895095538575</span>, <span class="number">51663065130083</span>, <span class="number">872561553334056</span>, <span class="number">142484860361584</span>, <span class="number">366178848478200</span>, <span class="number">582100262745320</span>, <span class="number">442278448664580</span>, <span class="number">658722265331043</span>, <span class="number">838584617412841</span>, <span class="number">618888833439999</span>, <span class="number">841459921663339</span>, <span class="number">442091548782434</span>, <span class="number">871146541604948</span>, <span class="number">361232391335863</span>, <span class="number">267110542973009</span>, <span class="number">98775266993905</span>, <span class="number">726739643823148</span>, <span class="number">208174460713647</span>, <span class="number">436363607002850</span>, <span class="number">109080678453891</span>, <span class="number">324963987304404</span>, <span class="number">747129957189381</span>, <span class="number">629090382627354</span>, <span class="number">326901225863526</span>, <span class="number">501411395019558</span>, <span class="number">605957277216355</span>, <span class="number">924462072245263</span>, <span class="number">681742264224629</span>, <span class="number">411620165150528</span>, <span class="number">978576627121525</span>, <span class="number">942031139574369</span>, <span class="number">93231172524187</span>, <span class="number">25708686373165</span>, <span class="number">706440278468996</span>, <span class="number">89296822699255</span>, <span class="number">609549323696105</span>, <span class="number">348801631103012</span>, <span class="number">301019857245003</span>, <span class="number">568429888021619</span>, <span class="number">696641838804966</span>, <span class="number">449524020606334</span>, <span class="number">717635512592258</span>, <span class="number">621428075417344</span>, <span class="number">165738165511311</span>, <span class="number">158410762741058</span>, <span class="number">161602488447872</span>, <span class="number">382183389407570</span>, <span class="number">328907274595208</span>, <span class="number">766746904253365</span>, <span class="number">107746916578801</span>, <span class="number">659628742394117</span>, <span class="number">39850489385122</span>, <span class="number">666051397127749</span>, <span class="number">474312422270748</span>, <span class="number">261139991035351</span>, <span class="number">482902564645709</span>, <span class="number">676254393545935</span>, <span class="number">110235980231748</span>, <span class="number">299458232064890</span>, <span class="number">656749827505033</span>, <span class="number">963908115927553</span>, <span class="number">722720798875107</span>, <span class="number">905063483734809</span>, <span class="number">990795739600264</span>, <span class="number">945238054995697</span>, <span class="number">176905467315680</span>, <span class="number">259111931319224</span>, <span class="number">422601938259904</span>, <span class="number">117159396440728</span>, <span class="number">409211931685475</span>, <span class="number">396232968955842</span>, <span class="number">114107681334804</span>, <span class="number">654283725172919</span>, <span class="number">351622702709255</span>, <span class="number">679987416555993</span>, <span class="number">641640026840576</span>, <span class="number">609806003053710</span>, <span class="number">482822259657548</span>, <span class="number">356518658585635</span>, <span class="number">61811805139089</span>, <span class="number">69776954369190</span>, <span class="number">207172995482414</span>, <span class="number">423131926063329</span>, <span class="number">943649643602454</span>, <span class="number">293676703457600</span>, <span class="number">563080562597489</span>, <span class="number">908147079943053</span>, <span class="number">310010658630352</span>, <span class="number">911778151386170</span>, <span class="number">817768239483378</span>, <span class="number">693612854841870</span>, <span class="number">214788531589375</span>, <span class="number">582512152031643</span>, <span class="number">757729953753937</span>, <span class="number">856571657360108</span>, <span class="number">680607952419663</span>, <span class="number">916077663157203</span>, <span class="number">731305462677020</span>, <span class="number">66803615445082</span>, <span class="number">419287139690140</span>, <span class="number">861593185826982</span>, <span class="number">616548630486552</span>, <span class="number">565256279891822</span>, <span class="number">282588409958136</span>, <span class="number">520541630210605</span>, <span class="number">767345971760815</span>, <span class="number">656739637241909</span>, <span class="number">379580509057753</span>, <span class="number">932925281918941</span>, <span class="number">251029261628871</span>, <span class="number">725236776074076</span>, <span class="number">670964848242950</span>, <span class="number">999244627445965</span>, <span class="number">916872955089430</span>, <span class="number">213213460785344</span>, <span class="number">211432261756385</span>, <span class="number">31972183664064</span>, <span class="number">951358022841870</span>, <span class="number">284145155237805</span>, <span class="number">785243558960859</span>, <span class="number">106902570235769</span>, <span class="number">766091290254305</span>, <span class="number">795338261445944</span>, <span class="number">309041437408721</span>, <span class="number">676408097676556</span>, <span class="number">502688492691042</span>, <span class="number">305931665252032</span>, <span class="number">139617780975991</span>, <span class="number">783387572420705</span>, <span class="number">318509103806236</span>, <span class="number">279274843786582</span>, <span class="number">960812728784</span>, <span class="number">765420810885287</span>, <span class="number">675301912122800</span>, <span class="number">220900827019425</span>, <span class="number">68258429521733</span>, <span class="number">500343726947640</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cip:</span><br><span class="line">    <span class="keyword">if</span> Legendre(i, p) == <span class="number">1</span>:</span><br><span class="line">        flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>
<h3 id="题2"><a class="markdownIt-Anchor" href="#题2"></a> <strong>题2</strong></h3>
<p>加密代码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">N = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># this is your hint</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line">n = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">while</span> gmpy2.jacobi(<span class="number">2</span>,n) == <span class="number">1</span>:</span><br><span class="line">    n = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">while</span> p:</span><br><span class="line">    pad = random.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">2023</span>)**<span class="number">2</span> </span><br><span class="line">    message = pad &lt;&lt; <span class="number">1</span> + p % <span class="number">2</span></span><br><span class="line">    cipher = <span class="built_in">pow</span>(message, e, n)</span><br><span class="line">    f.write(<span class="built_in">str</span>(cipher)+<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">    p //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 82923926622559692797413399236810034376108584757782065159980339372753222716219921590160225492580275427915752568365221414556256818363760115994728221502369868369002752050846974475991745713189008605110299692339240298965171454485097086422483463462325085226035968868532041299192645499454997827014006970410602586899</span></span><br><span class="line"><span class="string">c = 5268098693947601218678318823509471571641279409624943251746647090202567499752709232665697183505417421153691929827349942882009815935669724043141950887766485187370271734400923450597010490530223361843541245067817924748052146859671680883073052134640991595920714483571789648126922566108317490787317661128294600152</span></span><br><span class="line"><span class="string">N = 109628115860704625986265200696596612897391500367605131119456557370327560909624343904428497200076500891833170758691164654954696453518335303906271404285089946230989420194893031114417670761660150790683339988822977604942830134644107915859363425376973310923755737797468892908831973816405901129172182483392347465597</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>一个要注意的点，+的优先级是比&lt;&lt;高的，所以其实是message = pad &lt;&lt; (1 + p % 2)</p>
<p>因为这边n不是奇素数，所以不能用Legendre函数来判断</p>
<p>这题首先要了解一些关于雅可比的性质</p>
<p><img src="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212343224.png" class="lazyload" data-srcset="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212343224.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241221234311628" /></p>
<p>这边的a实际上应该是叫<strong>被测数</strong>，m是叫做<strong>模数</strong>，他们并不是分子和分母的关系，是一种特殊的数学表示</p>
<p>这边不止模数可以分解变成连乘，被测数如果也可以分解的话，也可以变成连乘</p>
<p>注：雅可比符号是勒让德符号的推广，但是根据雅可比符号的值不能判断同余式是否有解。</p>
<p>也就是</p>
<p><img src="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212348504.png" class="lazyload" data-srcset="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212348504.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241221234806991" /></p>
<p>一般有如下的性质</p>
<img src="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212357200.png" class="lazyload" data-srcset="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412212357200.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241221235740440" style="zoom:50%;" />
<p>还有一个性质就是</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><mfrac><msup><mi>n</mi><mi>e</mi></msup><mi>m</mi></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mi>n</mi><mi>m</mi></mfrac><mo fence="true">)</mo></mrow><mi>e</mi></msup></mrow><annotation encoding="application/x-tex">\left( \frac{n^e}{m} \right) = \left( \frac{n}{m} \right)^e
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.341392em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.890292em;vertical-align:-0.686em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.204292em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>不过主要用到的还是红框的性质，下面我们分情况讨论</p>
<p>当p的低位是1的时候，有</p>
<img src="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412220024808.png" class="lazyload" data-srcset="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412220024808.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241222002403118" style="zoom:50%;" />
<p>当p的低位是0的时候，有</p>
<img src="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412220024132.png" class="lazyload" data-srcset="https://macos-typora-1326830707.cos.ap-nanjing.myqcloud.com/img202412220024132.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241222002433487" style="zoom:50%;" />
<p>由此构造exp即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> jacobi</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Legendre</span>(<span class="params">n, p</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">82923926622559692797413399236810034376108584757782065159980339372753222716219921590160225492580275427915752568365221414556256818363760115994728221502369868369002752050846974475991745713189008605110299692339240298965171454485097086422483463462325085226035968868532041299192645499454997827014006970410602586899</span></span><br><span class="line">c = <span class="number">5268098693947601218678318823509471571641279409624943251746647090202567499752709232665697183505417421153691929827349942882009815935669724043141950887766485187370271734400923450597010490530223361843541245067817924748052146859671680883073052134640991595920714483571789648126922566108317490787317661128294600152</span></span><br><span class="line">N = <span class="number">109628115860704625986265200696596612897391500367605131119456557370327560909624343904428497200076500891833170758691164654954696453518335303906271404285089946230989420194893031114417670761660150790683339988822977604942830134644107915859363425376973310923755737797468892908831973816405901129172182483392347465597</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    res = [i <span class="keyword">for</span> i <span class="keyword">in</span> f.read().split(<span class="string">&#x27;n&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res[:-<span class="number">1</span>:]:</span><br><span class="line">    <span class="keyword">if</span> jacobi(<span class="built_in">int</span>(i) % n, n) == <span class="number">1</span>:</span><br><span class="line">        p = <span class="string">&#x27;1&#x27;</span> + p</span><br><span class="line">    <span class="keyword">elif</span> jacobi(<span class="built_in">int</span>(i) % n, n) == -<span class="number">1</span>:</span><br><span class="line">        p = <span class="string">&#x27;0&#x27;</span> + p</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(p, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> N % p == <span class="number">0</span></span><br><span class="line">q = N // p</span><br><span class="line">d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, N)))   <span class="comment">#b&#x27;flag&#123;Welcome_to_XMCVE!#$%$#%%^@%#&amp;!$%#!&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

  </div>
  
  
    
    <div class='footer'>
       <!-- 参考资料、相关资料等 -->
      
       <!-- 相关文章 -->
      
      <!-- 版权声明组件 -->
      
      <!-- 打赏组件 -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateModified" datetime="2024-12-23T11:14:05+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2024年12月23日</p>
  </a>
</div>

        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://example.com/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/&title=勒让德和雅可比 - suhanhan的博客&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qq.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qq.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://example.com/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/&title=勒让德和雅可比 - suhanhan的博客&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qzone.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qzone.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://example.com/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/&title=勒让德和雅可比 - suhanhan的博客&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/weibo.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/weibo.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
    
      
    
  </div>
</div>



        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/2024/12/23/Common%20Prime%20RSA/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>Common Prime RSA</p>
          <p class='content'>这种类型的话，一般有
p=2∗g∗a+1q=2∗g∗b+1h=2∗g∗a∗b+a+bn=2∗g∗h+1\begin{array}{l}
p=2*g*a + 1\\
q=2*g*b+1\\
h=2...</p>
        </a>
      
      
        <a class='next' href='/2024/12/21/2024%20CISCN%20x%20%E9%95%BF%E5%9F%8E%E6%9D%AF%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%20%E5%88%9D%E8%B5%9B%20WriteUp/'>
          <p class='title'>2024 CISCN x 长城杯铁人三项 初赛 WriteUp<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'> rasnd
加密代码：
123456789101112131415161718192021222324252627282930313233343536373839404142from Cryp...</p>
        </a>
      
    </div>
  
  <!-- 文章推荐 -->
  
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  


  <article class="post white-box shadow floatable blur" id="comments">
    <span hidden>
      <meta itemprop="discussionUrl" content="/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/index.html#comments">
    </span>
    <p ct><i class='fa-solid fa-comments'></i> 评论</p>
    
      <p cst>评论区</p>
    

    <div id="layoutHelper-comments"></div>

  </article>






</div>
<aside id='l_side' itemscope itemtype="https://schema.org.cn/WPSideBar">
  

  
    
    
      
    
  


<div class="widget-sticky">

  
  


<section class="widget toc-wrapper desktop mobile" id="toc-div" >
  
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


  <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%981"><span class="toc-text"> 题1：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%982"><span class="toc-text"> 题2</span></a></li></ol>
  </div>
</section>

  

</div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>


        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="https://schema.org.cn/WPFooter">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    
      <meting-js
        theme='#1BCDFC'
        autoplay='false'
        volume='0.7'
        loop='all'
        order='list'
        fixed='false'
        list-max-height='320px'
        server='netease'
        type='playlist'
        id='3175833810'
        list-folded='true'>
      </meting-js>
    
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
          
            
          
            
          
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/#6.0.0-alpha.1" target="_blank" class="codename">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_site_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © since 2017 XXX</a></p>

        </div>
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // 页面选择器 将dom对象缓存起来 see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // 页面主体
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // 向上
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // 整个导航栏
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1个
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // 搜索按钮   移动端 1个
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // 移动端导航栏
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // 搜索框 桌面端 移动端 1个
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  手机端 子菜单 多个
</script>

<script>
  
  volantis.css("https://cdn.bootcdn.net/ajax/libs/font-awesome/6.6.0/css/all.min.css");
  
  
  volantis.css("https://unpkg.com/font-awesome-animation@1.1.1/css/font-awesome-animation.min.css");
  
  
  volantis.css("https://cdn.bootcdn.net/ajax/libs/node-waves/0.7.6/waves.min.css");
  
</script>

<!-- required -->

  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>



<!-- internal -->

<script src="/js/app.js"></script>




<!-- rightmenu要在darkmode之前（ToggleButton） darkmode要在comments之前（volantis.dark.push）-->



<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("/js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("/js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("/js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
</script>




  <script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/19.1.3/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
</script>




  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1660614606622/libs/flying-pages/flying-pages.min.js"></script>







  <script>
  volantis.css("https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css");

  
    (async () => {
      // APlayer 需要在  MetingJS 之前加载
      await volantis.js("https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js")
      await volantis.js("https://unpkg.com/meting@2.0.1/dist/Meting.min.js")
    
    })();

    function SetAPlayerPlugin(){
      let Metings = document.querySelectorAll('meting-js');
      if (Metings.length === 0) {return;};
      if (Metings[0].aplayer && Metings[0].aplayer.on) {
        // improve the accessibility https://web.dev/button-name/
        document.querySelectorAll(".aplayer-icon-menu").forEach(e=>{
          e.setAttribute("aria-label","Aplayer Menu")
        })
        // message see: /layout/_plugins/message/script.ejs
        
          try {
            setTimeout(() => {
              Metings.forEach((item, index) => {
                const aplayerItem = item.aplayer; if(!aplayerItem) return;
                const rightAplayerCheck = 'true' === 'true'
                  && item.meta.id === '3175833810';
                if(rightAplayerCheck && typeof RightMenuAplayer !="undefined") RightMenuAplayer.checkAPlayer();
                if(aplayerItem.events.events.play.every(item => {return item.name !== 'messagePlay'})) {
                  aplayerItem.on('play', function messagePlay() {
                    let index = aplayerItem.list.index;
                    let title = aplayerItem.list.audios[index].title;
                    let artist = aplayerItem.list.audios[index].artist;
                    setTimeout(() => {
                      VolantisApp.message('音乐通知', title + ' - ' + artist, {
                        icon: 'fa-solid fa-play',
                        transitionIn: 'flipInX',
                        transitionOut: 'flipOutX'
                      });
                    }, 100)
                  });
                }
                if(aplayerItem.events.events.pause.every(item => {return item.name !== 'messagePause'})) {
                  aplayerItem.on('pause', function messagePause() {
                    let index = aplayerItem.list.index;
                    let title = aplayerItem.list.audios[index].title;
                    let artist = aplayerItem.list.audios[index].artist;
                    setTimeout(() => {
                      // 歌曲播放结束也会触发 pause 事件，为了避免错误提示，等待一会儿
                      if(aplayerItem.paused) {
                        VolantisApp.message('音乐通知', title + ' - ' + artist, {
                          icon: 'fa-solid fa-pause',
                          transitionIn: 'flipInX',
                          transitionOut: 'flipOutX'
                        });
                      }
                    }, 100)
                  });
                }
              });
            }, 500)
          } catch (error) { console.error(error); }
        
      }else{
        volantis.requestAnimationFrame(SetAPlayerPlugin)
      }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
      SetAPlayerPlugin();
    });
  
</script>




      <script>
  volantis.layoutHelper("comments",`<div id="giscus_container"></div>`)

  volantis.giscus = {};

  function check_giscus() {
    if (volantis.dark.mode === "dark") {
      volantis.giscus.Theme = 'dark';
    } else {
      volantis.giscus.Theme = 'light';
    }

    return document.getElementById("giscus_container");
  }

  function p_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;
    let cfg = Object.assign({"theme":{"light":"light","dark":"dark"},"repo":"suhanhan-cpu/suhanhan-cpu.github.io","repo-id":"R_kgDONaeQRw","category":"Announcements","category-id":"DIC_kwDONaeQR84ClCS7","mapping":"pathname","reactions-enabled":"1","emit-metadata":"0","lang":"zh-CN"},pdata.commentConfig)
    const script = document.createElement('script');
    script.setAttribute('src', 'https://giscus.app/client.js');
    Object.keys(cfg).forEach(k=>{
      if (k != "theme") {
        script.setAttribute('data-'+k, cfg[k]);
      }
    })
    script.setAttribute('data-theme', volantis.giscus.Theme);
    script.setAttribute('crossorigin', "anonymous");
    HEAD.appendChild(script);
  }

  function dark_giscus() {
    const HEAD = check_giscus();
    if (!HEAD) return;

    const message = {
      setConfig: {
        theme: volantis.giscus.Theme
      }
    };
    const giscusIframe = document.querySelector('iframe.giscus-frame');
    giscusIframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }
  p_giscus();
  volantis.dark.push(dark_giscus);
</script>

    




  <script defer src="https://npm.onmicrosoft.cn/penndu@16.0.0/bsz.js"></script>


<!-- optional -->

  <script>
  async function loadSearchScript() {
    
        
    
    return volantis.js("/js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // 打开并搜索 字符串 s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // 访问含有 ?s=xxx  的链接时打开搜索 // 与搜索引擎 structured data 相关: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // 搜索输入框获取焦点时加载搜索
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>



  
<script src="https://cdn.bootcdn.net/ajax/libs/node-waves/0.7.6/waves.min.js"></script>

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function () {
  Waves.attach('.flat-btn', ['waves-button']);
  Waves.attach('.float-btn', ['waves-button', 'waves-float']);
  Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
  Waves.attach('.flat-box', ['waves-block']);
  Waves.attach('.float-box', ['waves-block', 'waves-float']);
  Waves.attach('.waves-image');
  Waves.init();
});
</script>



  
<script src="https://unpkg.com/volantis-static@0.0.1660614606622/libs/comment_typing/comment_typing.js"></script>




  <script>



  function p_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(p_highlightjs_copyCode)

</script>










  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://cdn.bootcdn.net/ajax/libs/Swiper/11.1.14/swiper-bundle.min.css");
    volantis.js("https://cdn.bootcdn.net/ajax/libs/Swiper/11.1.14/swiper-bundle.min.js").then(() => {
      p_swiper();
    });
  }

  load_swiper();

  function p_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

</script>



  <script>
  volantis.css("https://cdn.bootcdn.net/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.min.css");
  volantis.js("https://cdn.bootcdn.net/ajax/libs/pace/1.2.4/pace.min.js").then(() => {
    Pace.options.restartOnPushState = false;
    // 阅读进度
    volantis.scroll.push(() => {
      Pace.stop();
      Pace.trigger('start');
      Pace.bar.update(volantis.scroll.progress() * 100);
      document.body.className = document.body.className.replaceAll("pace-running ","");
    },"阅读进度")
    // todo：配置项开关, 哪些页面添加阅读进度
  })
</script>




<script>
  function listenSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    const targets = []
    const sections = Array.from(navItems).forEach((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        link.getAttribute("href") ? decodeURI(link.getAttribute("href")).replace("#", "") : link.getAttribute("toc-action").split("toc-")[1] // 兼容 hexo-blog-encrypt
      );
      targets.push(target)
      // 解除 a 标签 href 的 锚点定位, a 标签 href 的 锚点定位 会随机启用?? 产生错位???
      if (link.getAttribute("href")) {
        link.setAttribute("toc-action", "toc-" + decodeURI(link.getAttribute("href")).replace("#", ""))
        link.removeAttribute("href")
      }
      // 配置 点击 触发新的锚点定位
      if (target && target.id) {
        link.addEventListener("click", (event) => {
          event.preventDefault();
          // 这里的 addTop 是通过错位使得 toc 自动展开.
          volantis.scroll.to(target, { addTop: 5, observer: true })
          // Anchor id
          history.pushState(null, document.title, "#" + target.id);
        });
      }
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // 方案一：
    volantis.activateNavIndex = 0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    if (targets[0]) {
      volantis.scroll.push(() => {
        if (targets[0].getBoundingClientRect().top >= 0) {
          volantis.activateNavIndex = 0
        } else if (targets[targets.length - 1].getBoundingClientRect().top < 0) {
          volantis.activateNavIndex = targets.length - 1
        } else {
          for (let index = 0; index < targets.length; index++) {
            const target0 = targets[index];
            const target1 = targets[(index + 1) % targets.length];
            if (target0.getBoundingClientRect().top < 0 && target1.getBoundingClientRect().top >= 0) {
              volantis.activateNavIndex = index
              break;
            }
          }
        }
        activateNavByIndex(navItems[volantis.activateNavIndex])
      })
    }

    // 方案二：
    // IntersectionObserver 不是完美精确到像素级别 也不是低延时性的
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", () => {
    volantis.requestAnimationFrame(listenSidebarTOC)
  });
</script>





<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // 页面加载完毕 样式加载失败，或是当前网速慢，或是开启了省流模式
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"https://schema.org.cn","@type":"Organization","name":"suhanhan的博客","url":"http://example.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"https://schema.org.cn","@type":"Person","name":"suhanhan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/","sameAs":["https://github.com/volantis-x"],"description":"目前主要还是记录一些关于CTF密码学的学习历程"},{"@context":"https://schema.org.cn","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"http://example.com/","name":"suhanhan的博客"}},{"@type":"ListItem","position":2,"item":{"@id":"http://example.com/categories/crypto/","name":"crypto"}},{"@type":"ListItem","position":2,"item":{"@id":"http://example.com/categories/crypto/日常学习/","name":"日常学习"}},{"@type":"ListItem","position":3,"item":{"@id":"http://example.com/2024/12/22/勒让德和雅可比/","name":"勒让德和雅可比"}}]},{"@context":"https://schema.org.cn","@type":"WebSite","name":"suhanhan的博客","url":"http://example.com/","keywords":null,"description":"目前主要还是记录一些关于CTF密码学的学习历程","author":{"@type":"Person","name":"suhanhan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/","description":"目前主要还是记录一些关于CTF密码学的学习历程"},"publisher":{"@type":"Organization","name":"suhanhan的博客","url":"http://example.com/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"http://example.com?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"https://schema.org.cn","@type":"BlogPosting","headline":"勒让德和雅可比","description":"记录一下关于勒让德和雅可比","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/"},"author":{"@type":"Person","name":"suhanhan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"http://example.com/"},"publisher":{"@type":"Organization","name":"suhanhan的博客","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"http://example.com/2024/12/22/%E5%8B%92%E8%AE%A9%E5%BE%B7%E5%92%8C%E9%9B%85%E5%8F%AF%E6%AF%94/","wordCount":0,"datePublished":"2024-12-21T16:35:00.000Z","dateModified":"2024-12-23T03:14:05.452Z","articleSection":"crypto","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}}]</script>




    </div>
    <!-- import body_end begin-->
    <!-- import body_end end-->
    <!-- Custom Files bodyEnd begin-->
    
    <!-- Custom Files bodyEnd end-->
    <!-- 页面点击小红心 -->
    <script type="text/javascript" src="/js/love.js"></script>
    <!-- 雪花特效 -->
    <!-- <script type="text/javascript" src="/js/snow.js"></script> ->
    <!-- 樱花特效 -->
    <script src="https://gcore.jsdelivr.net/gh/zyoushuo/Blog/hexo/js/sakura.js"></script>
    <!-- 鼠标滑动特效 -->
    <script src="https://gcore.jsdelivr.net/gh/zyoushuo/Blog/hexo/js/mouse_slide.js"></script>
    <!-- 动态标题效果 -->
    <script type="text/javascript" src="/js/drtitle.js"></script>
    <!-- 动态线条背景 -->
    <script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

   <!-- 数学公式转换 -->
   <link rel="stylesheet" href="https://unpkg.com/katex@0.16.4/dist/katex.min.css">
   <script defer src="https://unpkg.com/katex@0.16.4/dist/katex.min.js"></script>
   <script defer src="https://unpkg.com/katex@0.16.4/dist/contrib/auto-render.min.js"></script>

  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
